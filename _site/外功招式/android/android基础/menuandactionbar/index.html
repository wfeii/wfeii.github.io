<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.7.1 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>menu和actionbar - 杂记</title>




<meta name="description" content="context menu的创建">




<meta name="author" content="王飞">

<meta property="og:locale" content="zh_CN">
<meta property="og:site_name" content="杂记">
<meta property="og:title" content="menu和actionbar">


  <link rel="canonical" href="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E5%9F%BA%E7%A1%80/menuandactionbar/">
  <meta property="og:url" content="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E5%9F%BA%E7%A1%80/menuandactionbar/">



  <meta property="og:description" content="context menu的创建">

















  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-02-26T00:15:00+08:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "王飞",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>







<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="杂记 Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/">杂记</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/year-archive/">Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/categories/">Categories</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tags/">Tags</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/search/">Search</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://google.com">External Link</a></li>
          
        </ul>
        <button type="button">
          <span class="visually-hidden">切换菜单</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    



<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="http://localhost:4000/assets/images/bio-photo.jpeg" class="author__avatar" alt="王飞" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">王飞</h3>
    
      <p class="author__bio" itemprop="description">
        天行健君子以自强不息
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">关注</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">广东-深圳</span>
        </li>
      

      

      
        <li>
          <a href="mailto:wangfei199101@gamil.com">
            <meta itemprop="email" content="wangfei199101@gamil.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> 电子邮箱
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/wfeii" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="menu和actionbar">
    <meta itemprop="description" content="context menu的创建">
    <meta itemprop="datePublished" content="February 26, 2016">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">menu和actionbar
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  1 分钟读完
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h3 id="context-menu的创建">context menu的创建</h3>

<p>context menu可以使用到任意view上，但通常使用在ListView，GridView的items上，或者其他用户能够执行item操作的view集合。</p>

<p>有两种方式可以创建context menu</p>

<blockquote>
  <ul>
    <li>In a <strong><em>floating context menu</em></strong>. A menu appears as a floating list of menu items (similar to a dialog) when the user performs a long-click (press and hold) on a view that declares support for a context menu. Users can perform a contextual action on one item at a time.</li>
    <li>In the <strong><em>contextual action mode</em></strong>. This mode is a system implementation of ActionMode that displays a contextual action bar at the top of the screen with action items that affect the selected item(s). When this mode is active, users can perform an action on multiple items at once (if your app allows it).</li>
  </ul>
</blockquote>

<blockquote>
  <p><strong>NOTICE:</strong> <strong><em>contextual action mode</em></strong>在android3.0以后才可使用。</p>
</blockquote>

<!-- more -->

<h4 id="创建floating-context-menu">创建<strong><em>floating context menu</em></strong></h4>
<ul>
  <li>注册view到context menu中</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    /*1. 注册于context menu关联的iew*/
    registerForContextMenu(textview);
</code></pre></div></div>

<ul>
  <li>实现onCreateContextMenu()方法在activity或者fragment中
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/*2.实现onCreateContextMenu()方法,当注册的view长按时,就会调用onCreateContextMenu()方法*/
 @Override
 public void onCreateContextMenu(ContextMenu menu, View v,
                      ContextMenu.ContextMenuInfo menuInfo) {
     super.onCreateContextMenu(menu, v, menuInfo);
     MenuInflater inflater = getMenuInflater();
     inflater.inflate(R.menu.menu_share_items, menu);
 }
</code></pre></div>    </div>
  </li>
  <li>实现onContextItemSelected()方法
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /*3. 实现onContextItemSelected(),处理menu item选择的响应*/
 @Override
 public boolean onContextItemSelected(MenuItem item) {
     AdapterView.AdapterContextMenuInfo menuInfo =
         (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();
     switch (item.getItemId())
     {
         case R.id.menu_share:
             /*在这里作相应的处理*/
             return true;
         default:
             return super.onContextItemSelected(item);
     }

 }
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="创建contextual-action-mode">创建<strong><em>contextual action mode</em></strong></h4>

<p>对于android3.0及以上版本，应该使用<strong><em>contextual action mode</em></strong>代替<strong><em>floating context menu</em></strong></p>

<p>为view提供conteual操作，通常调用下面两种contextual操作中的一个或者两个：</p>

<ul>
  <li>长按View</li>
  <li>选择了一个checkbox或者类似的iew。</li>
</ul>

<p><strong>Tips</strong>: How your application invokes the contextual action mode and defines the behavior for each action depends on your design. There are basically two designs:</p>

<ul>
  <li>For contextual actions on individual, arbitrary views.</li>
  <li>For batch contextual actions on groups of items in a ListView or GridView (allowing the user to select multiple items and perform an action on them all).</li>
</ul>

<p><strong><em>对于单个view使用Context menu</em></strong><br />
为了当用户选择一个特定的View，调用Contextual action mode,需要做下面的操作</p>

<ul>
  <li>实现ActionMode.Callback接口</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  private ActionMode.Callback mCallback = new ActionMode.Callback() {

        /*当action mode被创建的的时候调用*/
        @Override
        public boolean onCreateActionMode(ActionMode mode, Menu menu) {
            mode.getMenuInflater().inflate(R.menu.menu_share_items,menu);
            return true;
        }

        /*每次调用onCreateActionMode()之后调用此方法,当mode无效的时候会调用多次*/
        @Override
        public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
            /*这里没有相应的处理*/
            return false;
        }

        /*当选择context item时,会调用此方法*/
        @Override
        public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
            switch (item.getItemId())
            {
                case R.id.menu_share:
                    Toast.makeText(ContextMenuActionBarModeActivity.this,
                            "share",Toast.LENGTH_LONG).show();
                    mode.finish();
                    return true;
                default:
                    return false;
            }
        }

        @Override
        public void onDestroyActionMode(ActionMode mode) {
            mCallback = null;
        }
    };
</code></pre></div></div>

<ul>
  <li>显示时调用startActionMode()方法（例如长按特定view）</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/*长按时显示action bar*/
        textView.setOnLongClickListener(new View.OnLongClickListener() {
            @Override
            public boolean onLongClick(View v) {
                if (mActionMode != null) {
                    return false;
                }
                mActionMode = startActionMode(mCallback);
                textView.setSelected(true);
                return true;
            }
        });
</code></pre></div></div>

<p><strong><em>对于listiew和GridView使用Context menu</em></strong><br />
对于批量处理listiew和GridView时需要做下面操作</p>
<ul>
  <li>实现AbaListView.MultiChiceModeListener接口，并调用ListView或者GridView的setMultiChioceModeListener()设置。</li>
  <li>ListView或者GridView调用setChoiceMode()方法，设置参数为CHOICE_MODE_MULTIPLE_MODE.</li>
</ul>

<h3 id="popup-menu的创建">popup menu的创建</h3>
<p>实现的步骤：</p>
<ol>
  <li>创建一个PopupMenu对象</li>
  <li>使用menu资源填充menu</li>
  <li>调用PopupMenu.show().</li>
</ol>

<h3 id="styling-the-action-bar">Styling the action bar</h3>
<p><a href="http://developer.android.com/guide/topics/ui/actionbar.html#Style">style action bar</a></p>

<p>###参考文档：
<a href="http://developer.android.com/guide/topics/ui/actionbar.html">参考文档1</a><br />
<a href="http://developer.android.com/guide/topics/ui/menus.html">参考文档2</a></p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> 分类: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/categories/#android" class="page__taxonomy-item" rel="tag">Android</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/categories/#android%E5%9F%BA%E7%A1%80" class="page__taxonomy-item" rel="tag">Android基础</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/categories/#%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F" class="page__taxonomy-item" rel="tag">外功招式</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> 更新时间:</strong> <time datetime="2016-02-26T00:15:00+08:00">February 26, 2016</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">分享</h4>
  

  <a href="https://twitter.com/intent/tweet?text=menu%E5%92%8Cactionbar%20http%3A%2F%2Flocalhost%3A4000%2F%25E5%25A4%2596%25E5%258A%259F%25E6%258B%259B%25E5%25BC%258F%2Fandroid%2Fandroid%25E5%259F%25BA%25E7%25A1%2580%2Fmenuandactionbar%2F" class="btn btn--twitter" title="分享 Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F%25E5%25A4%2596%25E5%258A%259F%25E6%258B%259B%25E5%25BC%258F%2Fandroid%2Fandroid%25E5%259F%25BA%25E7%25A1%2580%2Fmenuandactionbar%2F" class="btn btn--facebook" title="分享 Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2F%25E5%25A4%2596%25E5%258A%259F%25E6%258B%259B%25E5%25BC%258F%2Fandroid%2Fandroid%25E5%259F%25BA%25E7%25A1%2580%2Fmenuandactionbar%2F" class="btn btn--google-plus" title="分享 Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F%25E5%25A4%2596%25E5%258A%259F%25E6%258B%259B%25E5%25BC%258F%2Fandroid%2Fandroid%25E5%259F%25BA%25E7%25A1%2580%2Fmenuandactionbar%2F" class="btn btn--linkedin" title="分享 LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E5%9F%BA%E7%A1%80/menuandactionbar/" class="pagination--pager" title="menu和action bar
">向前</a>
    
    
      <a href="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E5%9F%BA%E7%A1%80/services/" class="pagination--pager" title="Services
">向后</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">猜您还喜欢</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E8%BF%9B%E9%98%B6/Touch%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86/" rel="permalink">Android事件传递机制
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  2 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Touch事件处理

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E8%BF%9B%E9%98%B6/%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/" rel="permalink">异步处理一
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  3 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">异步处理

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E5%9F%BA%E7%A1%80/contentprovider/" rel="permalink">ContentProvider
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  少于 1 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">什么是Android中的Content Provider

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/%E5%A4%96%E5%8A%9F%E6%8B%9B%E5%BC%8F/android/android%E5%9F%BA%E7%A1%80/services/" rel="permalink">Services
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  少于 1 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">基础

</p>
  </article>
</div>
        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>关注:</strong></li>
    
    
    
    
      <li><a href="https://github.com/wfeii"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 王飞. 技术来自于 <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="http://localhost:4000/assets/js/main.min.js"></script>








  </body>
</html>