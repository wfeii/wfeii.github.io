<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>文章 | 音视频技术部</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.72.0" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    

    
      

    

    
    
      <link href="/posts/index.xml" rel="alternate" type="application/rss+xml" title="音视频技术部" />
      <link href="/posts/index.xml" rel="feed" type="application/rss+xml" title="音视频技术部" />
      
    
    
    <meta property="og:title" content="文章" />
<meta property="og:description" content="专注于音视频技术输出" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://wfeii.github.io/posts/" />
<meta property="og:updated_time" content="2017-03-02T12:00:00-05:00" />
<meta itemprop="name" content="文章">
<meta itemprop="description" content="专注于音视频技术输出"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="文章"/>
<meta name="twitter:description" content="专注于音视频技术输出"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  
  
  <header class="cover bg-top" style="background-image: url('https://wfeii.github.io/images/top.jpg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        音视频技术部
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="关于 page">
              关于
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="文章 page">
              文章
            </a>
          </li>
          
        </ul>
      
      















    </div>
  </div>
</nav>

      <div class="tc-l pv4 pv6-l ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 white-90 mb0 lh-title">
          文章
        </h1>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      
  <article class="pa3 pa4-ns nested-copy-line-height nested-img">
    <section class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray"><p>发布的文章</p>
</section>
    <section class="flex-ns flex-wrap justify-around mt5">
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="https://wfeii.github.io/posts/_posts/%E9%87%8D%E6%9E%84-%E6%97%A2%E6%9C%89%E4%BB%A3%E7%A0%81%E7%9A%84%E8%AE%BE%E8%AE%A1/2016-08-30-%E9%87%8D%E6%9E%84%E5%8E%9F%E5%88%99/" class="link black dim">
        重构原则
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      {: .align-center}
何谓重构  重构 ： 对软件内部结构的一种调整，目的是在不改变软件可观察性的前提下，提高其可理解性，降低其修改的成本 。
 其实重构是在不改变代码的功能基础上，提高代码的可读性，提高代码的扩展性。
两顶帽子
添加新功能，重构。在软件开发中，两种情况不断变换，首先可能尝试添加新功能，其次意识到： 结构调整一下，功能更容易添加。于是就做一次重构，结构调整好之后，继续添加新功能，发现问题又会重构，就这样迭代。
 Notice: 在做新功能时候，不能只为添加新功能而添加新功能，需要保持代码的结构性，易读性。
 为何重构   重构改进软件设计
没有重构，程序的设计可能逐渐的不可控，程序的机构性会遭到破坏，代码的可读性也会降低。代码机构的流失是累积的，越难看出代码的设计意图，就越难保护其设计，代码的设计腐败的越快，代码的可控性就严重降低。 通过重构可以让所有的代码回归的到本身应该在的位置。重构帮助代码维持该有的设计。   重构使软件更容易理解
引用一句话，我觉得很恰当
 连傻子都能写出让机器机能运行的代码，但优秀的代码却是能让人理解的。
 程序设计很大程度上是跟计算机交流，但是除了跟计算机交流之外最重要的交流对象是人，写的连鬼都看不懂的代码，让人看个鬼，过了一段时间自己都看不懂自己写的代码就真是见了鬼了（这种情况比见到鬼容易多了，哈哈哈）。通过重构可以保证代码的可读性，而且通过重构可以更好的理解不熟悉的代码。
重构的开始可能只提留在细枝末节上。随着代码的简化，我们可以看到一些一些一切看不到的设计的层面的问题，有前辈把“早期重构”描述为“擦掉窗户上的污垢，使你看的更远”。如果没有重构，达不到这种层次。   重构帮助找到bug
对于代码的理解，可以帮助找到bug。通过重构更深入的理解代码的结构、行为，从而找到隐藏很深的bug。
 我不是一个伟大的程序员，我只是个有着一些优秀习惯的程序员 - Kent Beck
   提高编程速度
  良好的设计是快速开发的根本，拥有良好的设计才能快速的开发。如果没有良好的设计，或许一段时间内你的进展迅速，但恶劣的设计很快就让你的速度慢下来。会有大量的时间去调试，理解代码的逻辑，寻找重复的代码。最终坏的代码带来大的灾难。
重构一定程度提高了代码的扩展性，保持了代码良好的结构，添加新功能也就容易点。
何时重构  你不应该为了重构而重构，你之所以重构，是因为你想做别的什么事，而重构可以帮助你把事情做好。
 三次法则
 事不过三，三则重构
 出现了代码重复，说明需要重构了。
添加新功能时重构
 通过重构可以更好的理解代码的逻辑，理清代码的结构，更好的添加新功能。 代码的设计无法帮助我们轻松的添加想要的功能时候，就需要重构来更好的添加新功能。  修复bug时候
收到bug但是不能一眼看出bug的问题，很大程度说明代码的逻辑不够清楚，需要重构了。
复审代码时重构 复审者提出好的建议，然后一起探讨一些修改能否通过重构轻松实现，如果是这样，一起着手修改，这样保证了代码的质量
为什么重构有用
程序有两方面的价值
 今天可以为你做什么 明天可以为你做什么 我们都只关注今天想要程序做什么。修复bug,添加新功能，我们都是为了让程序能力更强，让它今天更有价值。如果为了今天的工作不择手段，导致不可能在明天完成任务，最终还是失败。重构是摆脱这个困境的道路。如果发现昨天的决定已经不能适应今天的情况，放心改变这个决定就是，然后就可以完成今天的决定，日复一日。  是什么程序难以修改
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="https://wfeii.github.io/posts/%E9%87%8D%E6%9E%84-%E6%97%A2%E6%9C%89%E4%BB%A3%E7%A0%81%E7%9A%84%E8%AE%BE%E8%AE%A1/2016-08-30-%E9%87%8D%E6%9E%84%E5%8E%9F%E5%88%99/" class="link black dim">
        重构原则
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      {: .align-center}
何谓重构  重构 ： 对软件内部结构的一种调整，目的是在不改变软件可观察性的前提下，提高其可理解性，降低其修改的成本 。
 其实重构是在不改变代码的功能基础上，提高代码的可读性，提高代码的扩展性。
两顶帽子
添加新功能，重构。在软件开发中，两种情况不断变换，首先可能尝试添加新功能，其次意识到： 结构调整一下，功能更容易添加。于是就做一次重构，结构调整好之后，继续添加新功能，发现问题又会重构，就这样迭代。
 Notice: 在做新功能时候，不能只为添加新功能而添加新功能，需要保持代码的结构性，易读性。
 为何重构   重构改进软件设计
没有重构，程序的设计可能逐渐的不可控，程序的机构性会遭到破坏，代码的可读性也会降低。代码机构的流失是累积的，越难看出代码的设计意图，就越难保护其设计，代码的设计腐败的越快，代码的可控性就严重降低。 通过重构可以让所有的代码回归的到本身应该在的位置。重构帮助代码维持该有的设计。   重构使软件更容易理解
引用一句话，我觉得很恰当
 连傻子都能写出让机器机能运行的代码，但优秀的代码却是能让人理解的。
 程序设计很大程度上是跟计算机交流，但是除了跟计算机交流之外最重要的交流对象是人，写的连鬼都看不懂的代码，让人看个鬼，过了一段时间自己都看不懂自己写的代码就真是见了鬼了（这种情况比见到鬼容易多了，哈哈哈）。通过重构可以保证代码的可读性，而且通过重构可以更好的理解不熟悉的代码。
重构的开始可能只提留在细枝末节上。随着代码的简化，我们可以看到一些一些一切看不到的设计的层面的问题，有前辈把“早期重构”描述为“擦掉窗户上的污垢，使你看的更远”。如果没有重构，达不到这种层次。   重构帮助找到bug
对于代码的理解，可以帮助找到bug。通过重构更深入的理解代码的结构、行为，从而找到隐藏很深的bug。
 我不是一个伟大的程序员，我只是个有着一些优秀习惯的程序员 - Kent Beck
   提高编程速度
  良好的设计是快速开发的根本，拥有良好的设计才能快速的开发。如果没有良好的设计，或许一段时间内你的进展迅速，但恶劣的设计很快就让你的速度慢下来。会有大量的时间去调试，理解代码的逻辑，寻找重复的代码。最终坏的代码带来大的灾难。
重构一定程度提高了代码的扩展性，保持了代码良好的结构，添加新功能也就容易点。
何时重构  你不应该为了重构而重构，你之所以重构，是因为你想做别的什么事，而重构可以帮助你把事情做好。
 三次法则
 事不过三，三则重构
 出现了代码重复，说明需要重构了。
添加新功能时重构
 通过重构可以更好的理解代码的逻辑，理清代码的结构，更好的添加新功能。 代码的设计无法帮助我们轻松的添加想要的功能时候，就需要重构来更好的添加新功能。  修复bug时候
收到bug但是不能一眼看出bug的问题，很大程度说明代码的逻辑不够清楚，需要重构了。
复审代码时重构 复审者提出好的建议，然后一起探讨一些修改能否通过重构轻松实现，如果是这样，一起着手修改，这样保证了代码的质量
为什么重构有用
程序有两方面的价值
 今天可以为你做什么 明天可以为你做什么 我们都只关注今天想要程序做什么。修复bug,添加新功能，我们都是为了让程序能力更强，让它今天更有价值。如果为了今天的工作不择手段，导致不可能在明天完成任务，最终还是失败。重构是摆脱这个困境的道路。如果发现昨天的决定已经不能适应今天的情况，放心改变这个决定就是，然后就可以完成今天的决定，日复一日。  是什么程序难以修改
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="https://wfeii.github.io/posts/_posts/android_optimize/2016-08-06-ui%E4%BC%98%E5%8C%96/" class="link black dim">
        UI优化
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      概述 总结来源与Google发布的性能优化的视频 Android Performance Patterns 和 Android Performance Optimizing Apps for Speed and Usability 对于用户感到卡顿,不流畅的原因有很多,比如Layout层级结构过深,动画过多,界面刷新,等等导致了CPU或者GPU的负担过重,16ms内无法完成一帧的绘制,导致了掉帧,从而表现出卡顿,不流畅.
绘制原理 为了更好的理解UI优化,在此之前先要说明一下硬件的基础.
VSYNC 两个概念 :
 Refresh Rate：代表了屏幕在一秒内刷新屏幕的次数，这取决于硬件的参数，例如60Hz。 Frame Rate：代表了GPU在一秒内绘制的帧数,例如60fps。  GPU获取图形数据绘制,然后硬件负责把绘制的内容显示再屏幕上,二者协调正常.
如果帧速率高于屏幕刷新速率,就会出现撕裂的现象,一部分显示当前的帧,一部分显示现在的帧,这种解决的方案就是双缓冲机制,GPU将帧写进存储器被成为back buffer,而存储器的次级区域成为frame buffer,当写入一帧时,它会开始填充back buffer,而framen buffer保持不变,现在刷新屏幕,使用frame buffer进行绘制,刷新屏幕,vsync触发,也会把back buffer复制到fragme buffer. 更具体的内容参考: Graphics
如果屏幕刷新速率高于帧速率时,就会导致屏幕显示还是上一帧的内容,从而出现卡顿,动画不流畅等现象
一帧画面绘制过程 了解了VSYNC的原理,下面该考虑应用程序是如何把画面绘制到屏幕上的了?或者是如何把XML文件转换成用户能够看到并理解的图像的?
其实这个过程的核心就是进行光栅化(rasterization)的处理过程.这个过程就是把一些高级的对象,比如字符串,形状等转换成屏幕上纹理中的像素点.光栅化是一个非常耗时的过程.正因如此,手机硬件上有一个特殊的部分用于提高光栅化的过程,叫做图像处理器,或者说GPU. 图像绘制到屏幕上首先在CPU上转换成多边形或者纹理,然后再传递到GPU进行光栅化处理,处理UI对象并转化成多边形和纹理并不是很快的操作,同样从CPU传递给GPU也不是那么快,这行就想办法较少UI对象转换的数量,和提交到GPU的数量,OpenGL ES API允许你将内容传递到GPU,并保存到GPU中,当以后再次绘制一个按钮的时候,只需要参考GPU内存中的已经存在的纹理.
渲染优化,尽可能多且快的将更多的数据上传到GPU,然后留在GPU中,尽可能长的时间里不去修改.每次更新GPU中的资源,你将会失去宝贵的处理时间.
下面说明什么时候会导致GPU资源更新. Android把xml语言转化成GPU能够识别的资源从而渲染到屏幕上,是通过Display List来实现的,一个Display List对象中基本上包含了所有GPU需要的渲染信息,Display List中包含了GPU可能需要的常用的资源列表,同时也包含了Open GL命令列表.
在某个视图第一次需要被渲染时,Display List就会被创建,当视图需要显示在屏幕时,会执行GPU的相关指令来进行渲染.
从上图可以看出
 只是View属性改变时,只是参考GPU内存中的已经存在,然后执行相关Open GL进行渲染, InvaliDated View也不会重新创建Display List View 布局改变,比如可见性,大小等  优化点 概述 渲染操作通常依赖于两个核心组件：CPU与GPU。CPU负责包括Measure，Layout，Record，Execute的计算操作，GPU负责Rasterization(栅格化)操作。CPU通常存在的问题的原因是存在非必需的视图组件，它不仅仅会带来重复的计算操作，而且还会占用额外的GPU资源。 对于CPU,应该尽量减少布局的层级深度,CPU减少measure等操作的时间,而对于GPU主要是减少不必要的过度绘制.
过度绘制 过度绘制是指同一帧内一个像素点绘制了多次,通过查看overdraw(开发者选项-&gt; 调试GPU过度绘制) 颜色代表了像素点过度绘制的次数:
    </div>
  </div>
</div>
</div>
      
    </section>

<ul class="pagination">
    
    <li class="page-item">
        <a href="/posts/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/posts/page/4/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/4/">4</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/posts/page/5/">5</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/6/">6</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/14/">14</a></li>
    
    
    <li class="page-item">
    <a href="/posts/page/6/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/posts/page/14/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>

</article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://wfeii.github.io/" >
    &copy;  音视频技术部 2020 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
